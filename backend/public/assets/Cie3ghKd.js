import{G as N,r as j,p as w,a9 as S,u as b,j as e,d as L,b as f,c as m,a as c,aa as k,e as A,Q as E,ab as C,k as F,f as D,ac as W,O as I,V as R,ad as T,L as O}from"./B7DAq_4k.js";import{a as g}from"./f1Q3cPys.js";import{s as M}from"./CGbjptuF.js";function K(s){return N({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"},child:[]}]})(s)}const v="settings";async function U(s){const t=new FormData;t.set("command",s);try{await j.post(w.join(v,"run-artisan"),t)}catch(i){if(!i.response)throw new Error(i.message);const o=i.response.data.message;if(i.response.data.errors)return Promise.reject(i.response.data.errors);throw new Error(o)}}async function _(s){try{const t=await j.get(w.join(v,"log"),{responseType:"blob"}),i=t.headers["content-disposition"],o=S.getFileNameFromContentDisposition(i,s);return{data:t.data,fileName:o}}catch(t){if(!t.response)throw new Error(t.message);const i=t.response.data.message;if(t.response.data.errors)return Promise.reject(t.response.data.errors);throw new Error(i)}}async function G(){try{await j.delete(w.join(v,"log"))}catch(s){if(!s.response)throw new Error(s.message);const t=s.response.data.message;if(s.response.data.errors)return Promise.reject(s.response.data.errors);throw new Error(t)}}const H="INW71KLOkjw-",a={article:H,"action-items":"KK3YxocgrrQ-","input-item":"AYxwSriXGHk-","button-item":"J19w24R6cwk-","sessions-list":"nvtidZ9dDoU-","current-session":"Cn-sgSHd1LY-"};function P({name:s}){const{user:t}=b();return t.user?s==="system"?e.jsx(Y,{}):s==="notifications"?e.jsx(e.Fragment,{}):s==="security"?e.jsx(q,{}):null:null}function Y(){var n;const{user:s}=b(),t=L("component.settings_content"),i=f.useRef(null),o=r=>{var y;const d=(y=i.current)==null?void 0:y.value.trim();if(!d)return;const h=r.currentTarget;h.classList.add(c["button-submitting"]),U(d).finally(()=>{h.classList.remove(c["button-submitting"])})},u=r=>{const d=r.currentTarget;d.classList.add(c["button-submitting"]),_("laravel.log").then(h=>{M(h.data,h.fileName)}).finally(()=>{d.classList.remove(c["button-submitting"])})},l=r=>{const d=r.currentTarget;d.classList.add(c["button-submitting"]),G().finally(()=>{d.classList.remove(c["button-submitting"])})};return e.jsx(e.Fragment,{children:((n=s.user)==null?void 0:n.role.name)==="admin"?e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:a.article,children:[e.jsx("h3",{children:t==null?void 0:t.artisancommand}),e.jsx("p",{children:t==null?void 0:t.runArtisanCommand}),e.jsx("label",{children:t==null?void 0:t.command}),e.jsx("input",{ref:i,className:m(c["input-d"],a["input-item"]),placeholder:"schedule:run"}),e.jsx("div",{className:a["action-items"],children:e.jsx("button",{onClick:o,className:m(c["action-item-d"],a["button-item"]),children:t==null?void 0:t.run})})]}),e.jsxs("article",{className:a.article,children:[e.jsx("h3",{children:t==null?void 0:t.logFile}),e.jsx("p",{children:t==null?void 0:t.logDescription}),e.jsxs("div",{className:a["action-items"],children:[e.jsx("button",{onClick:u,className:m(c["action-item-d"],a["button-item"]),children:t==null?void 0:t.download}),e.jsx("button",{onClick:l,className:m(c["action-item-white-border-red-d"],a["button-item"]),children:t==null?void 0:t.delete})]})]})]}):null})}function q(){var l,n;const{appLanguage:s}=b(),t=L("component.settings_content"),i=Number((l=k.getToken())==null?void 0:l.split("|")[0]),o=A({queryKey:[E.LOGIN_SESSIONS],queryFn:C,refetchOnWindowFocus:!1}),{mutate:u}=F({mutationFn:W,onSuccess:()=>{o.refetch()}});return e.jsxs(e.Fragment,{children:[o.isLoading?e.jsx(D,{}):null,e.jsxs("article",{className:a.article,children:[e.jsx("h3",{children:t==null?void 0:t.loginSession}),e.jsx("ul",{className:a["sessions-list"],children:(n=o.data)==null?void 0:n.map(r=>e.jsxs("li",{children:[e.jsx("big",{children:e.jsx("h4",{style:{marginBottom:"10px"},children:r.name.ip})}),r.id===i?e.jsx("b",{className:a["current-session"],children:t==null?void 0:t.currentSession}):null,e.jsxs("p",{children:[t==null?void 0:t.lastActivedAt," ",new Date(r.lastUsedAt).toLocaleString(s.language)]}),e.jsxs("p",{children:[t==null?void 0:t.loginedAt,": ",new Date(r.createdAt).toLocaleString(s.language)]}),e.jsxs("p",{children:[t==null?void 0:t.userAgent,": ",r.name.userAgent]}),e.jsx("button",{onClick:()=>{u(r.id)},className:m(c["action-item-white-border-red-d"],a["button-item"]),children:t==null?void 0:t.revoke})]},`session-${r.id}`))})]})]})}const B="_6C8X9kbJPBM-",p={"page-content":"lW05SfxOljg-","nav-bar":"KJgoiEk7Te8-","list-item":"ALgp3xs0id0-",current:B,"setting-content":"RKin23wICZc-"},x=800;function Z(){const s=L("page.settings"),[t,i]=f.useState(window.innerWidth>x),{name:o}=I(),u=R(),l=[{name:s==null?void 0:s.system,to:"system",icon:e.jsx(K,{}),isActive:!0},{name:s==null?void 0:s.notifications,to:"notifications",icon:e.jsx(g,{}),isActive:!0},{name:s==null?void 0:s.security,to:"security",icon:e.jsx(T,{}),isActive:!0}];return f.useEffect(()=>{!l.find(n=>n.to===o)&&t&&u(l[0].to)}),f.useEffect(()=>{const n=()=>{const r=window.innerWidth;r>x&&t||r<=x&&!t||i(d=>!d)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[t]),e.jsxs("main",{className:m(c["dashboard-d"],p["page-content"]),children:[window.innerWidth>x||o===void 0?e.jsxs("section",{className:p["nav-bar"],children:[e.jsx("h2",{style:{marginLeft:10},children:s==null?void 0:s.settings}),e.jsx("ul",{children:l.map(n=>{if(n.isActive)return e.jsx("li",{className:m(p["list-item"],n.to===window.location.pathname.split("/")[2]?p.current:""),children:e.jsxs(O,{to:n.to,children:[n.icon,n.name]})},`settings-${n.to}`)})})]}):null,o!==void 0?e.jsx("section",{className:p["setting-content"],children:e.jsx(P,{name:o})}):null]})}export{Z as default};
