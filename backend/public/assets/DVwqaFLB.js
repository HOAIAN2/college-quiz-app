import{b as x,d as F,k as P,j as e,c as l,f as C,R as q,a as i,D as E,l as _,F as w,m as L,n as A,u as I,y as R,i as T,e as M,Q as D,N as U,L as Q,U as k}from"./B7DAq_4k.js";import{R as G}from"./P0sdvjL8.js";import{a as O,b as K}from"./D3wkX606.js";import{s}from"./Bn4G0VvL.js";import{u as V}from"./f4lojql9.js";import{s as o}from"./C9q1ODpn.js";function $({onMutateSuccess:d,setShowPopUp:j}){const[c,h]=x.useState(!0),t=F("component.create_semester"),f=()=>{h(!0),setTimeout(()=>{j(!1)},L.TRANSITION_TIMING_FAST)},a=A(s),m=async r=>{var S;r.preventDefault(),(S=document.querySelector(`.${s["form-data"]}`))==null||S.querySelectorAll("input[name]").forEach(b=>{var y;b.classList.remove("error"),(y=a.getParentElement(b))==null||y.removeAttribute("data-error")});const p=r.nativeEvent.submitter,N=r.target,n=new FormData(N);await O(n),p.name==="save"?f():N.reset()},{mutate:v,isPending:u}=P({mutationFn:m,onError:r=>{a.showFormError(r)},onSuccess:d});return x.useEffect(()=>{h(!1)},[]),e.jsxs("div",{className:l(s["create-model-container"],c?s.hide:""),children:[u?e.jsx(C,{}):null,e.jsxs("div",{className:l(s["create-model-form"],c?s.hide:""),children:[e.jsxs("div",{className:s.header,children:[e.jsx("h2",{className:s.title,children:t==null?void 0:t.create}),e.jsx("div",{className:s["esc-button"],onClick:f,children:e.jsx(q,{})})]}),e.jsx("div",{className:s["form-content"],children:e.jsxs("form",{onSubmit:r=>{v(r)},onInput:r=>{a.handleOnInput(r)},className:s["form-data"],children:[e.jsxs("div",{className:s["group-inputs"],children:[e.jsxs("div",{className:s["wrap-item"],children:[e.jsx("label",{className:s.required,htmlFor:"name",children:t==null?void 0:t.name}),e.jsx("input",{id:"name",name:"name",className:l(i["input-d"],s["input-item"]),type:"text"})]}),e.jsxs("div",{className:s["wrap-item"],children:[e.jsx("label",{className:s.required,htmlFor:"start_date",children:t==null?void 0:t.startDate}),e.jsx(E,{initialValue:new Date,renderMonth:_,inputProps:{id:"start_date",name:"start_date",className:l(i["input-d"],s["input-item"])},closeOnSelect:!0,timeFormat:!1})]}),e.jsxs("div",{className:s["wrap-item"],children:[e.jsx("label",{className:s.required,htmlFor:"end_date",children:t==null?void 0:t.endDate}),e.jsx(E,{initialValue:new Date,renderMonth:_,inputProps:{id:"end_date",name:"end_date",className:l(i["input-d"],s["input-item"])},closeOnSelect:!0,timeFormat:!1})]})]}),e.jsxs("div",{className:s["action-items"],children:[e.jsxs("button",{name:"save",className:l(i["action-item-d"],u?"button-submitting":""),children:[e.jsx(w,{}),t==null?void 0:t.save]}),e.jsxs("button",{name:"save-more",className:l(i["action-item-white-d"],u?i["button-submitting"]:""),children:[e.jsx(w,{}),t==null?void 0:t.saveMore]})]})]})})]})]})}function X(){const{permissions:d,appLanguage:j}=I(),[c,h]=R(),[t,f]=x.useState(c.get("search")||""),a=V(t),m=F("page.subjects"),[v,u]=x.useState(!1),r=T(),p=M({queryKey:[D.PAGE_SEMESTERS,{search:a}],queryFn:()=>K(a),enabled:d.has("semester_view")});x.useEffect(()=>{!c.get("search")&&!a||(a===""?c.delete("search"):c.set("search",a),h(c))},[a,c,h]);const N=()=>{[D.PAGE_SEMESTERS].forEach(n=>{r.refetchQueries({queryKey:[n]})})};return d.has("semester_view")?e.jsxs(e.Fragment,{children:[v===!0?e.jsx($,{onMutateSuccess:N,setShowPopUp:u}):null,e.jsxs("div",{className:i["dashboard-d"],children:[d.hasAnyFormList(["semester_create","semester_update","semester_delete"])?e.jsx("div",{className:i["action-bar-d"],children:d.has("semester_create")?e.jsxs("div",{className:i["action-item-d"],onClick:()=>{u(!0)},children:[e.jsx(G,{})," ",m==null?void 0:m.add]}):null}):null,e.jsxs("div",{className:o["page-content"],children:[p.isLoading?e.jsx(C,{}):null,e.jsx("div",{className:o["filter-form"],children:e.jsxs("div",{className:o["wrap-input-item"],children:[e.jsx("label",{children:m==null?void 0:m.filter.search}),e.jsx("input",{onInput:n=>{f(n.currentTarget.value)},defaultValue:a,className:l(i["input-d"],o["input-item"])})]})}),e.jsx("div",{className:o["wrap-card-container"],children:e.jsx("div",{className:o["card-container"],children:p.data?p.data.map(n=>e.jsxs(Q,{to:String(n.id),className:l(i["dashboard-card-d"],o.card),children:[e.jsx("div",{className:o["card-top"],children:n.name}),e.jsxs("div",{className:o["card-bottom"],children:[e.jsx(k,{}),[new Date(n.startDate).toLocaleDateString(j.language),new Date(n.endDate).toLocaleDateString(j.language)].join(" - ")]})]},`semester-${n.id}`)):null})})]})]})]}):e.jsx(U,{to:"/"})}export{X as default};
