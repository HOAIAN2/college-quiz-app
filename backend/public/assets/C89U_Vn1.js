import{d as E,b as h,k as P,j as e,c as d,f as F,R as _,a as c,F as y,m as q,n as U,u as A,y as I,i as T,e as L,Q as C,N as Q,L as R,U as k}from"./B7DAq_4k.js";import{R as D}from"./P0sdvjL8.js";import{a as G,b as M}from"./jgNAs1tW.js";import{s}from"./Bn4G0VvL.js";import{u as B}from"./f4lojql9.js";import{s as o}from"./C9q1ODpn.js";function K({onMutateSuccess:m,setShowPopUp:l}){const t=E("component.create_subject"),[j,p]=h.useState(!0),n=()=>{p(!0),setTimeout(()=>{l(!1)},q.TRANSITION_TIMING_FAST)},i=U(s),f=async a=>{var b;a.preventDefault(),(b=document.querySelector(`.${s["form-data"]}`))==null||b.querySelectorAll("input[name]").forEach(v=>{var S;v.classList.remove("error"),(S=i.getParentElement(v))==null||S.removeAttribute("data-error")});const N=a.nativeEvent.submitter,r=a.target,w=new FormData(r);await G(w),N.name==="save"?n():r.reset()},{mutate:x,isPending:u}=P({mutationFn:f,onError:a=>{i.showFormError(a)},onSuccess:m});return h.useEffect(()=>{p(!1)},[]),e.jsxs("div",{className:d(s["create-model-container"],j?s.hide:""),children:[u?e.jsx(F,{}):null,e.jsxs("div",{className:d(s["create-model-form"],j?s.hide:""),children:[e.jsxs("div",{className:s.header,children:[e.jsx("h2",{className:s.title,children:t==null?void 0:t.create}),e.jsx("div",{className:s["esc-button"],onClick:n,children:e.jsx(_,{})})]}),e.jsx("div",{className:s["form-content"],children:e.jsxs("form",{onSubmit:a=>{x(a)},onInput:a=>{i.handleOnInput(a)},className:s["form-data"],children:[e.jsxs("div",{className:s["group-inputs"],children:[e.jsxs("div",{className:s["wrap-item"],children:[e.jsx("label",{className:s.required,htmlFor:"shortcode",children:t==null?void 0:t.shortcode}),e.jsx("input",{id:"shortcode",name:"shortcode",className:d(c["input-d"],s["input-item"]),type:"text"})]}),e.jsxs("div",{className:s["wrap-item"],children:[e.jsx("label",{className:s.required,htmlFor:"name",children:t==null?void 0:t.name}),e.jsx("input",{id:"name",name:"name",className:d(c["input-d"],s["input-item"]),type:"text"})]})]}),e.jsxs("div",{className:s["action-items"],children:[e.jsxs("button",{name:"save",className:d(c["action-item-d"],u?c["button-submitting"]:""),children:[e.jsx(y,{}),t==null?void 0:t.save]}),e.jsxs("button",{name:"save-more",className:d(c["action-item-white-d"],u?c["button-submitting"]:""),children:[e.jsx(y,{}),t==null?void 0:t.saveMore]})]})]})})]})]})}function z(){const{permissions:m}=A(),[l,t]=I(),[j,p]=h.useState(l.get("search")||""),n=B(j),i=E("page.subjects"),[f,x]=h.useState(!1),u=T(),a=L({queryKey:[C.PAGE_SUBJECTS,{search:n}],queryFn:()=>M(n),enabled:m.has("subject_view")});h.useEffect(()=>{!l.get("search")&&!n||(n===""?l.delete("search"):l.set("search",n),t(l))},[n,l,t]);const N=()=>{[C.PAGE_SUBJECTS].forEach(r=>{u.refetchQueries({queryKey:[r]})})};return m.has("subject_view")?e.jsxs(e.Fragment,{children:[f===!0?e.jsx(K,{onMutateSuccess:N,setShowPopUp:x}):null,e.jsxs("main",{className:c["dashboard-d"],children:[m.hasAnyFormList(["subject_create"])?e.jsx("section",{className:c["action-bar-d"],children:m.has("subject_create")?e.jsxs("button",{className:c["action-item-d"],onClick:()=>{x(!0)},children:[e.jsx(D,{})," ",i==null?void 0:i.add]}):null}):null,e.jsxs("section",{className:o["page-content"],children:[a.isLoading?e.jsx(F,{}):null,e.jsx("div",{className:o["filter-form"],children:e.jsxs("div",{className:o["wrap-input-item"],children:[e.jsx("label",{children:i==null?void 0:i.filter.search}),e.jsx("input",{onInput:r=>{p(r.currentTarget.value)},defaultValue:n,className:d(c["input-d"],o["input-item"])})]})}),e.jsx("div",{className:o["wrap-card-container"],children:e.jsx("div",{className:o["card-container"],children:a.data?a.data.map(r=>e.jsxs(R,{to:String(r.id),className:d(c["dashboard-card-d"],o.card),children:[e.jsx("div",{className:o["card-top"],children:e.jsx("p",{className:o.content,children:r.name})}),e.jsxs("div",{className:o["card-bottom"],children:[e.jsx(k,{}),r.shortcode]})]},`subject-${r.id}`)):null})})]})]})]}):e.jsx(Q,{to:"/"})}export{z as default};
