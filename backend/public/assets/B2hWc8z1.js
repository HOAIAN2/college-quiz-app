import{d as k,b as j,A as V,i as X,e as D,Q as I,k as J,j as e,c as i,f as Q,R as Y,a as u,C as z,D as ie,l as ne,F as Z,m as $,n as ce,o as xe,q as fe,s as je,G as de,u as W,t as Ne,v as oe,w as ve,x as ae,y as be,z as ye,N as _e,B as Se,E as we,H as Fe,M as Ce,I as Ue,J as Ee}from"./B7DAq_4k.js";import{R as Te}from"./P0sdvjL8.js";import{a as me,s as n,b as P}from"./BpR_VXzB.js";import{a as ue}from"./CnUC6V4v.js";import{u as H}from"./f4lojql9.js";import{s as d}from"./Bn4G0VvL.js";import{C as B}from"./DqT24KQI.js";import{s as qe}from"./CGbjptuF.js";import{I as Ae}from"./f1Q3cPys.js";import{a as Ie,b as Oe}from"./uNX39J6a.js";import{g as c}from"./CT1-FNmN.js";import{Y as Le}from"./BQMOT6f8.js";function Pe({role:o,onMutateSuccess:r,setShowPopUp:x}){const t=k("component.create_user"),[U,s]=j.useState(!0),[N,m]=j.useState(""),[q,E]=j.useState(""),_=H(N,V),f=H(q,V),S=X(),p=()=>{s(!0),setTimeout(()=>{x(!1)},$.TRANSITION_TIMING_FAST)},C=ce(d),T=D({queryKey:[I.AUTO_COMPLETE_SCHOOL_CLASS,{search:_}],queryFn:()=>ue(_),enabled:!!_}),l=D({queryKey:[I.AUTO_COMPLETE_FACULTY,{search:f}],queryFn:()=>me(f),enabled:!!f}),a=async h=>{var R;h.preventDefault(),(R=document.querySelector(`.${d["form-data"]}`))==null||R.querySelectorAll("input[name]").forEach(G=>{var K;G.classList.remove("error"),(K=C.getParentElement(G))==null||K.removeAttribute("data-error")});const L=h.nativeEvent.submitter,A=h.target,M=new FormData(A);M.append("role",o!==void 0?o:"student"),await xe(M),L.name==="save"?p():A.reset()},{mutate:w,isPending:v}=J({mutationFn:a,onError:h=>{C.showFormError(h)},onSuccess:r}),b=[{value:"male",label:t==null?void 0:t.genders.male},{value:"female",label:t==null?void 0:t.genders.female}];return j.useEffect(()=>(s(!1),()=>{S.removeQueries({queryKey:[I.AUTO_COMPLETE_FACULTY]}),S.removeQueries({queryKey:[I.AUTO_COMPLETE_SCHOOL_CLASS]})}),[S]),e.jsxs("div",{className:i(d["create-model-container"],U?d.hide:""),children:[v?e.jsx(Q,{}):null,e.jsxs("div",{className:i(d["create-model-form"],U?d.hide:""),children:[e.jsxs("div",{className:d.header,children:[e.jsx("h2",{className:d.title,children:[t==null?void 0:t.create,t&&o?t[o]:""].join(" ")}),e.jsx("div",{className:d["esc-button"],onClick:p,children:e.jsx(Y,{})})]}),e.jsx("div",{className:d["form-content"],children:e.jsxs("form",{onSubmit:h=>{w(h)},onInput:h=>{C.handleOnInput(h)},className:d["form-data"],children:[e.jsxs("div",{className:d["group-inputs"],children:[e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"email",children:t==null?void 0:t.email}),e.jsx("input",{id:"email",name:"email",className:i(u["input-d"],d["input-item"]),type:"text"})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{htmlFor:"phone_number",children:t==null?void 0:t.phoneNumber}),e.jsx("input",{id:"phone_number",name:"phone_number",className:i(u["input-d"],d["input-item"]),type:"text"})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"first_name",children:t==null?void 0:t.firstName}),e.jsx("input",{id:"first_name",name:"first_name",className:i(u["input-d"],d["input-item"]),type:"text"})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"last_name",children:t==null?void 0:t.lastName}),e.jsx("input",{id:"last_name",name:"last_name",className:i(u["input-d"],d["input-item"]),type:"text"})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"shortcode",children:t==null?void 0:t.shortcode}),e.jsx("input",{id:"shortcode",name:"shortcode",className:i(u["input-d"],d["input-item"]),type:"text"})]}),o==="student"?e.jsxs("div",{style:{zIndex:2},className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"school_class_id",children:t==null?void 0:t.class}),e.jsx(B,{name:"school_class_id",onInput:h=>{m(h.currentTarget.value)},options:T.data?T.data.map(h=>({label:h.name,value:String(h.id)})):[]})]}):o==="teacher"?e.jsxs("div",{style:{zIndex:2},className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"faculty_id",children:t==null?void 0:t.faculty}),e.jsx(B,{name:"faculty_id",onInput:h=>{E(h.currentTarget.value)},options:l.data?l.data.map(h=>({label:h.name,value:String(h.id)})):[]})]}):null,e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"",children:t==null?void 0:t.genders.gender}),e.jsx(z,{name:"gender",defaultOption:b[0],options:b,className:d["custom-select"]})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"address",children:t==null?void 0:t.address}),e.jsx("input",{id:"address",name:"address",className:i(u["input-d"],d["input-item"]),type:"text"})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"birth_date",children:t==null?void 0:t.birthDate}),e.jsx(ie,{initialValue:new Date,renderMonth:ne,inputProps:{id:"birth_date",name:"birth_date",className:i(u["input-d"],d["input-item"])},closeOnSelect:!0,timeFormat:!1})]}),e.jsxs("div",{className:d["wrap-item"],children:[e.jsx("label",{className:d.required,htmlFor:"password",children:t==null?void 0:t.password}),e.jsx("input",{id:"password",name:"password",className:i(u["input-d"],d["input-item"]),type:"password"})]})]}),e.jsxs("div",{className:d["action-items"],children:[e.jsxs("button",{name:"save",className:i(u["action-item-d"],v?u["button-submitting"]:""),children:[e.jsx(Z,{}),t==null?void 0:t.save]}),e.jsxs("button",{name:"save-more",className:i(u["action-item-white-d"],v?u["button-submitting"]:""),children:[e.jsx(Z,{}),t==null?void 0:t.saveMore]})]})]})})]})]})}const De="KkpRKhI-FNM-",Me="GDM4XZ5B2Lc-",Qe="ZOY2bqDKZLs-",ke="XGKflGoGOQE-",O={"export-users-container":"TJECMunZR4A-",hide:De,"export-users-form":"ab9CRc9kXf4-",header:Me,title:Qe,"esc-button":"xlrI4ojm1aQ-","form-data":"EKeMVc1F8NU-","group-inputs":"_0vsdLFLQ-rM-","wrap-item":"zv3SNso9D5E-",label:ke,"action-items":"_9Q4EAmQwYMo-"};function Re({role:o,setExportMode:r}){const x=k("component.export_users"),[t,U]=j.useState(!0),[s,N]=j.useState(!1),m=()=>{U(!0),setTimeout(()=>{r(!1)},$.TRANSITION_TIMING_FAST)},q=D({queryKey:[I.USER_EXPORTABLE_FIELDS],queryFn:()=>fe(o)}),E=f=>{f.preventDefault();const S=new FormData(f.currentTarget),p=[];S.forEach(T=>{p.push(T)}),N(!0);const C=`Export-${o}-${new Date().toISOString().split("T")[0]}.xlsx`;je(o,p,C).then(T=>{qe(T.data,T.fileName)}).finally(()=>{N(!1)})},_=f=>{var S;(S=document.querySelector(`.${O["form-data"]}`))==null||S.querySelectorAll('input[type="checkbox"]').forEach(p=>{f==="all"?p.checked=!0:p.checked=!1})};return j.useEffect(()=>{U(!1)},[]),e.jsx("div",{className:i(O["export-users-container"],t?O.hide:""),children:e.jsxs("div",{className:i(O["export-users-form"],t?O.hide:""),children:[e.jsxs("div",{className:O.header,children:[e.jsx("h2",{className:O.title,children:x==null?void 0:x.selectFields}),e.jsx("div",{className:O["esc-button"],onClick:m,children:e.jsx(Y,{})})]}),q.isLoading?e.jsx(Q,{}):null,q.data?e.jsxs("form",{onSubmit:E,className:O["form-data"],children:[q.data.map(f=>e.jsxs("div",{className:O["wrap-item"],children:[e.jsx("input",{id:f.field,type:"checkbox",name:"fields[]",value:f.field}),e.jsx("label",{htmlFor:f.field,className:O.label,children:f.fieldName})]},`exportable-${f.field}`)),e.jsxs("div",{className:O["action-items"],children:[e.jsx("button",{name:"save",className:i(u["action-item-d"],s?u["button-submitting"]:""),children:x==null?void 0:x.save}),e.jsx("button",{onClick:()=>{_("none")},style:{width:"fit-content"},type:"button",className:u["action-item-white-d"],children:x==null?void 0:x.deselectAll}),e.jsx("button",{onClick:()=>{_("all")},type:"button",className:u["action-item-white-d"],children:x==null?void 0:x.selectAll})]})]}):null]})})}const Ge="rNf7i2P7X-g-",Ke="EJoH-ULhdqA-",He="rVIQPxvpMn4-",Ve="cLbTvOz2zzk-",ze="_7ovbqyvKLrE-",y={"import-data-container":"eA-lRzu8lwo-",hide:Ge,"import-data-form":"nZZLxrHNXeY-",header:Ke,title:He,"esc-button":"_4tHLLGL4qJU-","form-data":"p84dVBY3foo-","drag-area":"ZHn09Q1Qrdg-","drag-area-dashed":"hyhMe7vtqSA-",drag:Ve,"drag-area-content":"VLJiPRYHiqk-","file-name":"gZ2UxrVZQMo-","have-file":"xw1Gl-1FpAI-","action-items":"wFjAxuqboK4-",pending:ze};function Be({title:o,teamplateUrl:r,icon:x,importFunction:t,onMutateSuccess:U,setImportMode:s}){const N=k("component.import_data"),[m,q]=j.useState(!0),[E,_]=j.useState(),f=j.useRef(null),S=()=>{q(!0),setTimeout(()=>{s(!1)},$.TRANSITION_TIMING_FAST)},p=a=>{const w=a.currentTarget.files;if(!w)return _(void 0);const v=w[0];_(v||void 0)},C=a=>{a.preventDefault(),a.currentTarget.classList.remove(y.drag);const v=a.dataTransfer.files;f.current&&(f.current.files=v);const b=v[0];_(b||void 0)},l=J({mutationFn:async()=>{E&&await t(E)},onSuccess:U});return j.useEffect(()=>{q(!1)},[]),e.jsxs("div",{className:i(y["import-data-container"],m?y.hide:""),children:[l.isPending?e.jsx(Q,{}):null,e.jsxs("div",{className:i(y["import-data-form"],m?y.hide:""),children:[e.jsxs("div",{className:y.header,children:[e.jsx("h2",{className:y.title,children:o}),e.jsx("div",{className:y["esc-button"],onClick:S,children:e.jsx(Y,{})})]}),e.jsxs("div",{className:y["form-data"],children:[e.jsx("div",{className:y["drag-area"],children:e.jsxs("label",{htmlFor:"file",onDragOver:a=>{a.preventDefault(),a.currentTarget.classList.add(y.drag)},onDragLeave:a=>{a.preventDefault(),a.currentTarget.classList.remove(y.drag)},onDrop:C,className:y["drag-area-dashed"],children:[e.jsx("div",{className:y["drag-area-content"],children:E?e.jsxs("div",{className:i(y["file-name"],y["have-file"]),title:E.name,children:[x,e.jsx("p",{className:y.content,children:E.name})]}):e.jsx("div",{className:y["file-name"],children:e.jsx(Ae,{})})}),e.jsx("input",{ref:f,id:"file",onChange:p,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",type:"file",name:"file",hidden:!0})]})}),e.jsxs("div",{className:y["action-items"],children:[e.jsx("button",{onClick:()=>{l.mutate()},name:"save",className:i(u["action-item-d"],l.isPending?y.pending:""),children:N==null?void 0:N.save}),e.jsx("a",{className:u["action-item-white-d"],href:r,download:"",children:N==null?void 0:N.downloadTemplate})]})]})]})]})}function Ye(o){return de({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 25.438c-17.84 0-35.582 3.547-52.063 10.375-16.48 6.827-31.512 16.853-44.125 29.468-12.612 12.617-22.645 27.675-29.468 44.157C123.52 125.92 119.994 143.66 120 161.5c.005 17.832 3.547 35.558 10.375 52.03 6.828 16.474 16.858 31.488 29.47 44.095 12.61 12.607 27.65 22.646 44.124 29.47l.218.092c10.032 4.135 20.52 7.02 31.218 8.657l.125 18.906.314 49.188H165.97v40h70.124l.375 62.875.124 20 40-.25-.125-20-.376-62.625h69.937v-40h-70.186l-.313-49.438-.124-18.47c11.188-1.61 22.154-4.6 32.625-8.936 16.476-6.823 31.515-16.862 44.126-29.47 12.61-12.606 22.64-27.62 29.47-44.093 6.827-16.472 10.37-34.198 10.374-52.03.005-17.84-3.52-35.58-10.344-52.063-6.823-16.482-16.856-31.54-29.47-44.156-12.61-12.614-27.643-22.64-44.123-29.468-16.48-6.827-34.224-10.374-52.063-10.374zm0 40c12.536 0 25.17 2.514 36.75 7.312 11.58 4.798 22.294 11.947 31.156 20.813 8.863 8.865 15.987 19.573 20.78 31.156 4.796 11.58 7.318 24.213 7.314 36.75-.004 12.53-2.515 25.173-7.313 36.75-4.797 11.575-11.95 22.264-20.812 31.124-8.862 8.86-19.58 16.018-31.156 20.812-11.58 4.795-24.19 7.28-36.72 7.28-12.53.002-25.14-2.485-36.72-7.28-11.576-4.794-22.293-11.953-31.155-20.812-8.862-8.86-16.015-19.55-20.813-31.125-4.797-11.577-7.308-24.22-7.312-36.75-.004-12.537 2.518-25.17 7.313-36.75 4.794-11.584 11.918-22.292 20.78-31.157 8.863-8.866 19.576-16.015 31.157-20.813 11.58-4.798 24.214-7.313 36.75-7.313z"},child:[]}]})(o)}function $e(o){return de({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M292.563 65.656v40h85.156l-81.658 82.656-12.937 13.125c-9.054-6.765-18.936-12.412-29.406-16.75-16.478-6.825-34.23-10.343-52.064-10.343-17.835 0-35.553 3.52-52.03 10.344-16.48 6.824-31.514 16.858-44.126 29.468-12.613 12.612-22.643 27.647-29.47 44.125-6.825 16.48-10.373 34.228-10.374 52.064 0 17.836 3.52 35.553 10.344 52.03 6.825 16.48 16.888 31.514 29.5 44.126 12.612 12.612 27.647 22.643 44.125 29.47 16.478 6.824 34.195 10.374 52.03 10.374 17.837 0 35.586-3.55 52.064-10.375 16.477-6.827 31.512-16.857 44.124-29.47 12.61-12.612 22.644-27.647 29.47-44.125 6.823-16.478 10.343-34.196 10.342-52.03 0-17.836-3.518-35.587-10.344-52.064-4.183-10.098-9.583-19.646-16.03-28.436l13.218-13.406 81.844-82.875v85.875h40V65.656H292.562zm-90.907 148.688c12.533 0 25.17 2.516 36.75 7.312 11.58 4.797 22.263 11.95 31.125 20.813 8.863 8.86 16.017 19.545 20.814 31.124 4.796 11.58 7.312 24.217 7.312 36.75 0 12.533-2.517 25.14-7.312 36.72-4.796 11.577-11.92 22.292-20.78 31.155-8.864 8.862-19.578 16.014-31.158 20.81-11.58 4.798-24.216 7.313-36.75 7.314-12.533 0-25.14-2.516-36.72-7.313-11.578-4.795-22.292-11.95-31.155-20.81-8.86-8.864-16.015-19.578-20.81-31.158-4.798-11.58-7.314-24.185-7.314-36.718 0-12.534 2.516-25.17 7.313-36.75l.093-.22c4.796-11.494 11.91-22.13 20.718-30.937 8.808-8.805 19.444-15.892 30.94-20.687l.218-.094c11.58-4.795 24.185-7.313 36.718-7.312z"},child:[]}]})(o)}const Ze="-vXS3jF2fyw-",Xe="_2JODSaYg6tM-",Je="Hl-NpPlybIg-",We="_5nUo5MRVHFI-",re={badge:Ze,red:Xe,green:Je,yellow:We};function le({color:o,content:r}){return e.jsx("div",{title:r,className:i(re.badge,re[o])})}function ge({id:o,onMutateSuccess:r,setShowPopUp:x}){var R,G,K,g;const[t,U]=j.useState(!0),s=k("component.view_user"),{permissions:N}=W(),[m,q]=j.useState(""),[E,_]=j.useState(""),f=H(m,V),S=H(E,V),p=X(),C=()=>{U(!0),setTimeout(()=>{x(!1)},$.TRANSITION_TIMING_FAST)},T=ce(c),l=!N.has("user_update"),a=D({queryKey:[I.USER_DETAIL,{id:o}],queryFn:()=>Ne(o)}),w=D({queryKey:[I.AUTO_COMPLETE_SCHOOL_CLASS,{search:f}],queryFn:()=>ue(f),enabled:!!(f&&N.has("school_class_view"))}),v=D({queryKey:[I.AUTO_COMPLETE_FACULTY,{search:S}],queryFn:()=>me(S),enabled:!!(S&&N.has("faculty_view"))}),b=async F=>{var ee;F.preventDefault(),(ee=document.querySelector(`.${c["form-data"]}`))==null||ee.querySelectorAll("input[name]").forEach(se=>{var te;se.classList.remove("error"),(te=T.getParentElement(se))==null||te.removeAttribute("data-error")});const he=F.target,pe=new FormData(he);await ve(pe,o)},{mutate:h,isPending:L}=J({mutationFn:b,onError:F=>{T.showFormError(F)},onSuccess:r}),A=[{value:"male",label:s==null?void 0:s.genders.male},{value:"female",label:s==null?void 0:s.genders.female}],M=[{value:"1",label:s==null?void 0:s.status.active},{value:"0",label:s==null?void 0:s.status.inactive}];return j.useEffect(()=>(U(!1),()=>{p.removeQueries({queryKey:[I.USER_DETAIL,{id:o}]}),p.removeQueries({queryKey:[I.AUTO_COMPLETE_FACULTY]}),p.removeQueries({queryKey:[I.AUTO_COMPLETE_SCHOOL_CLASS]})}),[p,o]),e.jsxs("div",{className:i(c["view-model-container"],t?c.hide:""),children:[L?e.jsx(Q,{}):null,e.jsxs("div",{className:i(c["view-model-form"],t?c.hide:""),children:[e.jsxs("div",{className:c.header,children:[e.jsx("h2",{className:c.title,children:oe.getFullName((R=a.data)==null?void 0:R.firstName,(G=a.data)==null?void 0:G.lastName)}),e.jsx("div",{className:c["esc-button"],onClick:C,children:e.jsx(Y,{})})]}),e.jsxs(e.Fragment,{children:[a.isLoading?e.jsx(Q,{}):null,e.jsx("div",{className:c["form-content"],children:a.data?e.jsxs("form",{onSubmit:F=>{h(F)},onInput:F=>{T.handleOnInput(F)},className:c["form-data"],children:[e.jsxs("div",{className:c["group-inputs"],children:[e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"email",children:s==null?void 0:s.email}),e.jsx("input",{id:"email",disabled:l,defaultValue:a.data.email,name:"email",className:i(u["input-d"],c["input-item"]),type:"text"})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{htmlFor:"phone_number",children:s==null?void 0:s.phoneNumber}),e.jsx("input",{id:"phone_number",disabled:l,defaultValue:a.data.phoneNumber||"",name:"phone_number",className:i(u["input-d"],c["input-item"]),type:"text"})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"first_name",children:s==null?void 0:s.firstName}),e.jsx("input",{id:"first_name",disabled:l,defaultValue:a.data.firstName,name:"first_name",className:i(u["input-d"],c["input-item"]),type:"text"})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"last_name",children:s==null?void 0:s.lastName}),e.jsx("input",{id:"last_name",disabled:l,defaultValue:a.data.lastName,name:"last_name",className:i(u["input-d"],c["input-item"]),type:"text"})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"shortcode",children:s==null?void 0:s.shortcode}),e.jsx("input",{id:"shortcode",disabled:l,defaultValue:a.data.shortcode,name:"shortcode",className:i(u["input-d"],c["input-item"]),type:"text"})]}),a.data.role.name==="student"?e.jsxs("div",{style:{zIndex:3},className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"school_class_id",children:s==null?void 0:s.class}),e.jsx(B,{name:"school_class_id",defaultOption:{label:(K=a.data.schoolClass)==null?void 0:K.name,value:a.data.schoolClass?String(a.data.schoolClass.id):""},onInput:F=>{q(F.currentTarget.value)},options:w.data?w.data.map(F=>({label:F.name,value:String(F.id)})):[]})]}):a.data.role.name==="teacher"?e.jsxs("div",{style:{zIndex:3},className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"faculty_id",children:s==null?void 0:s.faculty}),e.jsx(B,{name:"faculty_id",defaultOption:{label:(g=a.data.faculty)==null?void 0:g.name,value:a.data.faculty?String(a.data.faculty.id):""},onInput:F=>{_(F.currentTarget.value)},options:v.data?v.data.map(F=>({label:F.name,value:String(F.id)})):[]})]}):null,e.jsxs("div",{className:c["wrap-item"],style:{zIndex:2},children:[e.jsx("label",{className:c.required,htmlFor:"",children:s==null?void 0:s.genders.gender}),e.jsx(z,{name:"gender",defaultOption:a.data.gender==="male"?A[0]:A[1],disabled:l,options:A,className:c["custom-select"]})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"address",children:s==null?void 0:s.address}),e.jsx("input",{id:"address",disabled:l,defaultValue:a.data.address,name:"address",className:i(u["input-d"],c["input-item"]),type:"text"})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"birth_date",children:s==null?void 0:s.birthDate}),e.jsx(ie,{initialValue:new Date(a.data.birthDate),renderMonth:ne,inputProps:{id:"birth_date",disabled:l,name:"birth_date",className:i(u["input-d"],c["input-item"])},closeOnSelect:!0,timeFormat:!1})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{className:c.required,htmlFor:"",children:s==null?void 0:s.status.accountStatus}),e.jsx(z,{name:"is_active",defaultOption:a.data.isActive?M[0]:M[1],disabled:l,options:M,className:c["custom-select"]})]}),e.jsxs("div",{className:c["wrap-item"],children:[e.jsx("label",{htmlFor:"password",children:s==null?void 0:s.password}),e.jsx("input",{id:"password",disabled:l,placeholder:s==null?void 0:s.leaveBlank,name:"password",className:i(u["input-d"],c["input-item"]),type:"password"})]})]}),N.has("user_update")?e.jsx("div",{className:c["action-items"],children:e.jsxs("button",{name:"save",className:i(u["action-item-d"],L?u["button-submitting"]:""),children:[e.jsx(Z,{}),s==null?void 0:s.save]})}):null]}):null})]})]})]})}function es({role:o,data:r,searchParams:x,onMutateSuccess:t,setSearchParams:U,setSelectedRows:s}){const{permissions:N}=W(),m=k("component.users_table"),[q,E]=j.useState(!1),[_,f]=j.useState(!1),[S,p]=j.useState(0),C=(l,a)=>{const w=a.target;if(w.nodeName==="INPUT"){const v=w,b=Number(x.get("per_page"))||10;v.checked?s(h=>(h.add(l),h.size===b&&f(!0),structuredClone(h))):s(h=>(h.delete(l),h.size!==b&&f(!1),structuredClone(h)));return}p(l),E(!0)},T=l=>{const a=l.currentTarget,w=`.${n["column-select"]}>input`;document.querySelectorAll(w).forEach(b=>{const h=b;h.checked=a.checked}),a.checked?(s(b=>(b.clear(),r&&r.data.forEach(h=>{b.add(h.id)}),structuredClone(b))),f(!0)):(s(b=>(b.clear(),structuredClone(b))),f(!1))};return j.useEffect(()=>{f(!1)},[r]),e.jsxs(e.Fragment,{children:[q===!0?e.jsx(ge,{id:S,onMutateSuccess:t,setShowPopUp:E}):null,e.jsxs("div",{className:n["table-content"],children:[e.jsx("table",{className:n.main,children:e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:n["table-header"],children:[N.has("user_delete")?e.jsx("th",{className:i(n["column-select"],n.column),children:e.jsx("input",{type:"checkbox",checked:_,onChange:T})}):null,e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.shortcode}),e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.name}),o==="student"?e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.class}):o==="teacher"?e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.faculty}):null,e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.email}),e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.address}),e.jsx("th",{className:i(n.column,n.medium),children:m==null?void 0:m.header.status})]})}),e.jsx("tbody",{children:r?r.data.map(l=>{var a,w;return e.jsxs("tr",{onClick:v=>{C(l.id,v)},children:[N.has("user_delete")?e.jsx("td",{className:i(n.column,n.small,n["column-select"]),children:e.jsx("input",{type:"checkbox"})}):null,e.jsx("td",{className:i(n.column,n.medium),children:l.shortcode}),e.jsxs("td",{className:i(n.column,n.large,n["column-content-name"],l.gender=="male"?n.male:n.female),children:[l.gender=="male"?e.jsx($e,{}):e.jsx(Ye,{}),oe.getFullName(l.firstName,l.lastName)]}),o==="student"?e.jsx("td",{className:i(n.column,n.medium),children:(a=l.schoolClass)==null?void 0:a.name}):o==="teacher"?e.jsx("td",{className:i(n.column,n.medium),children:(w=l.faculty)==null?void 0:w.name}):null,e.jsx("td",{className:i(n.column,n.medium),children:l.email}),e.jsx("td",{className:i(n.column,n.medium),children:l.address}),e.jsx("td",{className:i(n.column,n["column-content-status"],n.small),children:l.isActive?e.jsx(le,{color:"green",content:m==null?void 0:m.status.active}):e.jsx(le,{color:"red",content:m==null?void 0:m.status.inactive})})]},l.id)}):null})]})}),r?e.jsxs("div",{className:n["table-footer"],children:[e.jsxs("span",{children:[r.from," - ",r.to," / ",r.total]}),e.jsx("div",{className:n["table-links"],children:e.jsx("div",{className:n["link-content"],children:r.links.map(l=>isNaN(Number(l.label))?e.jsx("button",{className:n["next-previous"],onClick:()=>{if(!l.url)return;const a=new URL(l.url);x.set("page",a.searchParams.get("page")||"1"),U(x)},children:l.label==="..."?"...":l.label.includes("Next")?e.jsx(Ie,{}):e.jsx(Oe,{})},o+l.label):e.jsx("button",{className:i(u["button-d"],l.active?"":n.inactive),onClick:()=>{if(!l.url)return;const a=new URL(l.url);x.set("page",a.searchParams.get("page")||"1"),U(x)},children:l.label},o+l.label))})})]}):null]})]})}const ss={admin:"",student:ae+"/data/Import_Student_Template.xlsx",teacher:ae+"/data/Import_Teacher_Template.xlsx"};function ps({role:o}){const r=k("page.users"),{permissions:x}=W(),[t,U]=j.useState(!1),[s,N]=j.useState(!1),[m,q]=j.useState(!1),[E,_]=j.useState(!1),[f,S]=j.useState(new Set),[p,C]=be(),[T,l]=j.useState(p.get("search")||""),a=H(T),w=X(),v=D({queryKey:[I.PAGE_USERS,{role:o,page:p.get("page")||"1",perPage:p.get("per_page")||"10",search:a}],queryFn:()=>ye({role:o,page:Number(p.get("page")),perPage:Number(p.get("per_page")),search:a}),enabled:x.has("user_view")}),b=async A=>Ue(A,o),h=async()=>{await Ee(Array.from(f))},L=()=>{[I.PAGE_USERS,I.PAGE_DASHBOARD].forEach(A=>{w.refetchQueries({queryKey:[A]})})};return j.useEffect(()=>{S(new Set)},[v.data]),j.useEffect(()=>()=>{window.location.pathname.includes(o)||C(new URLSearchParams)}),j.useEffect(()=>{!p.get("search")&&!a||(a===""?p.delete("search"):p.set("search",a),C(p))},[a,p,C]),x.has("user_view")?e.jsxs(e.Fragment,{children:[t===!0?e.jsx(Pe,{role:o,onMutateSuccess:L,setShowPopUp:U}):null,s===!0?e.jsx(Re,{role:o,setExportMode:N}):null,E===!0?e.jsx(Le,{message:(r==null?void 0:r.deleteMessage.replace("@n",String(f.size)))||"",mutateFunction:h,setShowPopUp:_,onMutateSuccess:L,langYes:r==null?void 0:r.langYes,langNo:r==null?void 0:r.langNo}):null,m===!0?e.jsx(Be,{title:[r==null?void 0:r.import,r?r[o]:""].join(" "),icon:e.jsx(Se,{}),teamplateUrl:ss[o],importFunction:b,setImportMode:q,onMutateSuccess:L}):null,e.jsxs("main",{className:u["dashboard-d"],children:[x.hasAnyFormList(["user_view","user_create","user_update","user_delete"])?e.jsxs("section",{className:u["action-bar-d"],children:[x.has("user_create")?e.jsxs("div",{className:u["action-item-d"],onClick:()=>{U(!0)},children:[e.jsx(Te,{})," ",r==null?void 0:r.add]}):null,x.has("user_create")?e.jsxs("div",{className:u["action-item-white-d"],onClick:()=>{q(!0)},children:[e.jsx(we,{})," ",r==null?void 0:r.import]}):null,x.has("user_view")?e.jsxs("div",{className:u["action-item-white-d"],onClick:()=>{N(!0)},children:[e.jsx(Fe,{})," ",r==null?void 0:r.export]}):null,f.size>0&&x.has("user_delete")?e.jsxs("div",{onClick:()=>{_(!0)},className:u["action-item-white-border-red-d"],children:[e.jsx(Ce,{})," ",r==null?void 0:r.delete]}):null]}):null,e.jsxs("section",{className:P["table-page-content"],children:[e.jsxs("div",{className:P["filter-form"],children:[e.jsxs("div",{className:P["wrap-input-item"],children:[e.jsx("label",{children:r==null?void 0:r.filter.perPage}),e.jsx(z,{defaultOption:{label:p.get("per_page")||"10",value:p.get("per_page")||"10"},options:[{label:"10",value:"10"},{label:"20",value:"20"},{label:"30",value:"30"},{label:"40",value:"40"},{label:"50",value:"50"}],onChange:A=>{p.set("per_page",A.value),C(p)},className:P["custom-select"]})]}),e.jsxs("div",{className:P["wrap-input-item"],children:[e.jsx("label",{children:r==null?void 0:r.filter.search}),e.jsx("input",{onInput:A=>{l(A.currentTarget.value)},defaultValue:a,className:i(u["input-d"],P["input-item"])})]})]}),e.jsxs("div",{className:P["wrap-table"],children:[v.isLoading?e.jsx(Q,{}):null,v.isError?null:e.jsx(es,{role:o,data:v.data,searchParams:p,onMutateSuccess:L,setSearchParams:C,setSelectedRows:S})]})]})]})]}):e.jsx(_e,{to:"/"})}export{ps as default};
